from pwn import *
n = 26507591511689883990023896389022361811173033984051016489514421457013639621509962613332324662222154683066173937658495362448733162728817642341239457485221865493926211958117034923747221236176204216845182311004742474549095130306550623190917480615151093941494688906907516349433681015204941620716162038586590895058816430264415335805881575305773073358135217732591500750773744464142282514963376379623449776844046465746330691788777566563856886778143019387464133144867446731438967247646981498812182658347753229511846953659235528803754112114516623201792727787856347729085966824435377279429992530935232902223909659507613583396967
e = 65537
'''def sign(r,x):
	print r.recvline()
	r.send('1 sign\n')
	print r.recv()
	y=x.encode('base64')
	r.send('y\n')
	k=r.recv()[:-1]
	print k
	return k

r=remote('blind.q.2019.volgactf.ru',7070)
sol1 = 408479
sol2 = 17531213514041
sol1 = ('0'+hex(sol1)[2:]).decode('hex')
print sol1.encode('base64')
sol2 = ('0'+hex(sol2)[2:]).decode('hex')
print sol2.encode('base64')
sol1 = int(sign(r,sol1))
sol2 = int(sign(r,sol2))
sol = (sol1 * sol2)%n
r.recvline()
r.send(str(sol) + 'cat flag')
print r.recv()
'''
sol1 = 25546621042567021743921441656485106150773028771975739792395292839524991698929912254223690969899881717956277954181362001941084170643987790900354897720201198641241865168483559029881918212009804506724025449021632061776772429841832820822248791924286727129159693622880243660612170666428534633987262142793095526136680155894125768641992318145581399148611597046840862019696663630366704554135979924498320452192198270792856017753126515861945695789558862132300276176002546820728010847776307161844028813344882966643480384082356366425666269055026587464161965878493074595945942518737289891784899462357520515374555016064334840465912
sol2 = 17638787469642039435318581385618808297268376774234879657983959486588488518602104982122891156593317044292766030845687731228499038739756875964186679785382736177049112662098526726358737509567429436403098863630151350780807034720456854963415607468739968754202506998385349296290129607434002404738918120538229071656978017808466596814950226784314700317088934348540608219987543730472643691009060755872926833135443517648919261924577246564970061451282151317589401229797945517104524760889684000361260339607131828972845536284354091935086720068566032733497050626156914558343862499749490577165803099065730472936347462992778753796941
print (sol1*sol2)%n
