
c = [17827132501379851035, 5851056884845272704, 1845704364124646650, 15836507227607295275, 1106964868274904891, 5845592521729879726, 91646535857391446, 15397131229965405302, 11191725307616665442, 12734483972872158347, 4506487327544846708, 18067557784618292003, 6510915725349296939, 14639792346136501810, 17276930815729787739, 11988420509120517358, 15360971264850667768, 58489665258696137, 4550637667337808278, 10392893776676367229, 14606305828993504764, 18176990710301326162, 12609713052491255944, 9000379525426469430, 13378472137155166126, 2752353359552421473, 1900460475227305085, 2114252013602600216, 15879419165026576562, 13969456881896057436, 11880820437209096217, 214333111987599963]
h = [519973979, 623383399, 1579195702, 1754023387, 3117142133, 1107028747, 1942991234, 2649665059, 102387579, 25959660, 4058586302, 2666013584, 171393018, 1875267814, 3702795761, 2155770919, 3288100614, 1782923713, 1531624490, 4019319433, 517109090, 2213388397, 404678846, 2261904930, 103076579, 629575836, 3065088411, 2270982688, 875718778, 1194519484, 1037961642, 577068345, 3380374039, 3728200265, 451658484, 1426379237, 1134146754, 136605769, 3149519492, 4228760231, 2342373475, 1890212848, 2893405259, 1884392206, 1676763632, 50388826, 4006273939, 918966644, 1000414053, 1481330241, 1879319862, 312167869, 3709576948, 2933699470, 3502068483, 214900782, 55883729, 542385118, 3116403337, 661241624, 2031173049, 873763702, 1713836441, 998578259, 290461426, 3749290885, 2296004039, 3405981950, 3292023544, 2061086519, 3510401205, 218282476, 1530806889, 3636287883, 2743698663, 2384736143, 4042249846, 373401650, 2098957877, 2940480206, 1015584170, 1769173508, 2420771613, 2002166859, 3313971679, 1164976756, 1726236129, 1121501871, 3385841262, 2668770947, 2141972091, 2974249608, 2064772452, 1201471501, 2575511574, 3316818187, 3167425598, 3842019234, 3950823601, 2430345589]
encflag = 0x3b1c62de25bcad16207435ebf54460579d6926856e40c3cd65fa53955af20c06b6e0f17c568d1e5fe053ab21df3c9602

'''
h = [2064265675, 182859978, 2856690246, 2534233280, 4200260927, 706928661, 3016402890, 1567115979, 4209583380, 1811297069, 4289213772, 3006089675, 3824614788, 2394511153, 2767062852, 2667655671, 916722350, 3440451943, 2301886501, 1349887566, 776968824, 318327182, 57586521, 3702479277, 2317685155, 552781401, 1303693837, 295264696, 2835111859, 610903286, 607585745, 2719236697, 980027563, 1640801072, 1470901492, 2692399026, 2512972349, 3531281787, 1346043110, 3616216907, 2832581274, 2171974157, 885492294, 177045862, 325385071, 1600095852, 1286497602, 3239185337, 3015656725, 2472554026, 2946475752, 726558943, 1526095920, 2420068560, 688921569, 841234002, 3756976767, 2057715321, 3266318774, 477299116, 1605961636, 3316835316, 3940799182, 2190304962, 1395447028, 2107911932, 4280795496, 1432891609, 1108380374, 3694758387, 2142835681, 588328488, 412851357, 2593273144, 2190275656, 1550223421, 2874201419, 1054699856, 1285215685, 190346163, 589531680, 3336767000, 980843366, 1300021926, 1692287141, 675076012, 1585545396, 1356772758, 3856608123, 402480911, 2477486520, 307472056, 187354508, 308640995, 2077045362, 3956684548, 1414556200, 1008429115, 1220853028, 1010285126]
hidden = [3081829525, 2889684024, 227121410, 648094772, 3810445793, 3881193531, 1209321102, 2044652762, 3381255863, 1329725430, 3154089359, 3294819059, 1476951562, 797450747, 344247130, 1928266992, 3860228668, 4009778558, 3658238922, 241346314, 3655910744, 2228540495, 1117900758, 1680721284, 2544923846, 1390180657, 3290270268, 3845911600, 1045023481, 561680651, 1877545862, 1432007886, 3194394850, 1383165281, 3940892023, 925431135, 2528756774, 2967284459, 1471719768, 3844250251, 4248668553, 835643420, 3212217422, 4083531876, 4198032490, 2192062000, 1842364736, 1310634551, 1206270021, 659977582, 750633269, 2147213144, 1944155068, 211506848, 1286174363, 2477023822, 943967823, 4004866663, 1700248857, 3304946575, 3707940096, 3280754238, 288192009, 16142252, 2348200895, 2882567011, 2431311594, 2452879149, 1997789974, 3253279889, 167283682, 2864020792, 3080867052, 3993162330, 3653812343, 3839577519, 1277465151, 1538349755, 1401731014, 2507379707, 4232997794, 3890457963, 193267577, 3228472089, 4235754801, 1435404862, 938068046, 4085357118, 831348179, 4156359623, 1746011431, 1837521846, 3450904822, 3288842337, 13132755, 127116245, 870386188, 1392477312, 2921460207, 2697841330]
s= [8865953567462194325, 785377628146963512, 12269391181599316226, 10884449058682905652, 18039983319942089185, 3036235483481264187, 12955351765319206542, 6730711880888675546, 18080022950266396343, 7779461676025380854, 18422032879446889871, 12911056846263087859, 16426595435734924810, 10284347092839703035, 11884444455660735322, 11457493865862202608, 3937292516622494268, 14776628582654434686, 9886527244557110218, 5797722949488387850, 3337055692747490648, 1367204838346380367, 247332225503317974, 15902027410513446276, 9954381945694614726, 2374178040522242353, 5599322397202025020, 1268152216829293616, 12176712715951786745, 2623809634950615307, 2609560906168341382, 11679032685130069198, 4209186335457974498, 7047186944864906593, 6317473807718497655, 11563765765377684831, 10793134057236055078, 15166739791092722411, 5781211137927850328, 15531533354651523723, 12165843939340683657, 9328557972907812892, 3803160446802234446, 760406191265661028, 1397518242749670506, 6872359356997318192, 5525465128814788928, 13912195089408373303, 12952147011043735621, 10619538679923111278, 12655016994047639861, 3120546900948541272, 6554532068903187388, 10394115319489320608, 2958895609650181787, 3613072529350222414, 16136092347040779855, 8837820012178008679, 14028732314341063961, 2049984096934656911, 6897552708958596352, 14245699211718579774, 16925603607081743881, 9407288180072665004, 5993399350908597183, 9053412813670742883, 18385876658615410410, 6154222601820698413, 4760457459856038678, 15868866442039991441, 9203409170764172258, 2526851618129149240, 1773183079505087724, 11138023347068260954, 9407162315398758519, 6658158898527817135, 12344601097999258175, 4529901390154259131, 5519959336782968774, 817530547511464955, 2532019289788935074, 14331305143262489963, 4212690179661825913, 5583551659481404185, 7268317930272095537, 2899429395289508414, 6809865623081437262, 5827294627799079486, 16564005762604293587, 1728642354165646279, 10640723581426861351, 1320582426791402422, 804681488069075190, 1325602983018741857, 8920841902111613907, 16993830734375658453, 6075472618224421388, 4331170070651700352, 5243523831404032495, 4339141578503080626]
c = [7022114846864373539, 16928320884134661997, 15084262680342252739, 401529391480273261, 5954325154004351633, 15710006917584809355, 12057710652594067644, 14023390996037274694, 12987611701528080834, 13134136040130786825, 8499136491443199042, 2975694066338954891, 12271246463344458121, 17916666591070927517, 4128423524621225618, 16555777551948692236, 6244484715894788085, 11245901768376781784, 7193882588398607158, 16135473943603080892, 1102833189688516843, 5502085058887991949, 10867550113385864317, 2383523410657889833, 164893760868019292, 7810504565421967117, 12561676598196075586, 8406019736766382255, 10980948925022613734, 14425663607354844931, 8562687506129887213, 2552420425151766254]
'''

n = (1 << 64) - 1
y = PolynomialRing(Integers(n), 32, 'y').gens()

def rotate_32(x):
    tmp = x & 0xffffffff
    tmp1 = x >> 32
    return tmp1 + (tmp << 32)

y2 = []
for i in range(32):
    y2.append(0)

for i in range(32, 100):
    tmp = 0
    for j in range(32):
        if (i-32+j) < 32:   
            tmp += y[i+j-32] * c[j]
        else:
            tmp += y2[i-32+j] * c[j]
        tmp += (h[i + j - 32] << 32) * c[j] 
    tmp -= (h[i] << 32)
    y2.append(tmp)

data = []
data1 = []
x=64
for i in range(x):
    data.append(vector(ZZ, y2[99-i].coefficients()))
    data1.append(int(y2[99-i].coefficients()[32]))
data1 = vector(data1)

'''
M = matrix(32)
for i in range(32):
    for j in range(32):
        M[i,j] = data[i][j]

hidden = vector(hidden)
s = vector(s)
V1 = M * hidden[:32] + data1
tmp = []
for i in V1:
    tmp.append(i % n)
print(tmp)
print(hidden[32:64])
'''

def babai1(A, w):
    C = max(max(row) for row in A.rows())
    B = matrix([list(row) + [0] for row in A.rows()] + [list(w) + [C]])
    B = B.LLL(delta=0.9)
    return w - vector(B.rows()[-1][:-1])

data0 = vector([1<<31] * 32 + list(data1))

for i in range(32, 32+x):
    data0[i] = n-data1[i-32] + (1<<31)

M = matrix(32+x)
for i in range(32+x):
    if i < 32:
        M[i, i] = 1
        for j in range(x):
            M[i, 32 + j] = data[j][i]
    else:
        M[i, i] = (1 << 64) - 1

data2=(babai1(M, data0))
tmp = []
for i in range(32):
    tmp.append(data2[i])
for i in range(32,32+x):
    tmp.append(data2[i] + data1[i-32] - n)

print(tmp[:32])

#[1972144224, 2627872095, 25616827, 2546659650, 1486700945, 3135390776, 1645382154, 3270169363, 4022243039, 1105862731, 1531958259, 858484709, 2387452042, 2898936390, 2232410918, 2656271523, 2681765966, 314333569, 1103213179, 2785173453, 3238467204, 1214172424, 3198812070, 676224441, 1206100467, 280956036, 3219171367, 46386436, 3748391170, 1850995786, 2975153847, 945238126]